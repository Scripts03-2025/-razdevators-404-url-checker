/**
 * updateStatsPanel v1.0 (24.03.2025)
 * 
 * üìä –§—É–Ω–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Å—ã–ª–æ–∫
 * 
 * –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
 * - –°—á–∏—Ç–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–æ–≤ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤)
 * - –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ –Ω–∏—Ö 404 –∏ 403
 * - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ E
 * - –í—ã–≤–æ–¥–∏—Ç –≤—Å—ë —ç—Ç–æ –≤ —è—á–µ–π–∫–∏ H1‚ÄìH4 –Ω–∞ –ª–∏—Å—Ç–µ "404 (–Ω–µ –º–µ–Ω—è—Ç—å!)"
 * 
 * –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π:
 * v1.0 ‚Äì 24.03.2025 ‚Äì –±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–≤—Å–µ–≥–æ, 404, 403, –¥–∞—Ç–∞)
 */

function updateStatsPanel() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("404 (–Ω–µ –º–µ–Ω—è—Ç—å!)");
  const codes = sheet.getRange("D7:D").getValues().flat().filter(Boolean);

  const total = codes.length;
  const count404 = codes.filter(c => String(c) === "404").length;
  const count403 = codes.filter(c => String(c) === "403").length;
  const lastDate = sheet.getRange("E7:E").getValues().flat().filter(Boolean).pop();

  sheet.getRange("H1").setValue(`–í—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤: ${total}`);
  sheet.getRange("H2").setValue(`404 –æ—à–∏–±–æ–∫: ${count404}`);
  sheet.getRange("H3").setValue(`403 –æ—à–∏–±–æ–∫: ${count403}`);
  sheet.getRange("H4").setValue(`–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${lastDate || "-"}`);
}
