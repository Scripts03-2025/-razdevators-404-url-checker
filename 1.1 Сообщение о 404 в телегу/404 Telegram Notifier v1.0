// 404 Telegram Notifier v1.0
// https://chatgpt.com/c/67f3ca15-e1bc-8010-afd7-110fad0af306

function send404ToTelegram() {
  const TELEGRAM_BOT_TOKEN = '8165444239:AAFGA_0Qi_sdFGaEKLc95Hr5fZjCd2UIWnM';
  const TELEGRAM_CHAT_ID = '8003377702';
  
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('404 (–Ω–µ –º–µ–Ω—è—Ç—å!)');
  const data = sheet.getDataRange().getValues();

  // –ü—Ä–æ—Ö–æ–¥–∏–º —Å 1-–π —Å—Ç—Ä–æ–∫–∏ (–ø—Ä–æ–ø—É—Å–∫–∞—è –∑–∞–≥–æ–ª–æ–≤–∫–∏)
  for (let i = 1; i < data.length; i++) {
    const status = data[i][3]; // –ö–æ–ª–æ–Ω–∫–∞ D
    const url = data[i][1];    // –ö–æ–ª–æ–Ω–∫–∞ B

    if (status === 404 && url) {
      const message = `*–ë–∞–Ω 404*\n\n${url}`;
      sendTelegramMessage(TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID, message);
    }
  }
}

function sendTelegramMessage(token, chatId, message) {
  const payload = {
    chat_id: chatId,
    text: message,
    parse_mode: 'Markdown'
  };

  const options = {
    method: 'post',
    contentType: 'application/json',
    payload: JSON.stringify(payload)
  };

  UrlFetchApp.fetch(`https://api.telegram.org/bot${token}/sendMessage`, options);
}

/*
üìñ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç (v1.0):

1. –°–∫—Ä–∏–ø—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –ª–∏—Å—Ç—É "404 (–Ω–µ –º–µ–Ω—è—Ç—å!)".
2. –í –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Ä–∞–≤–Ω–∞ –ª–∏ –∫–æ–ª–æ–Ω–∫–∞ D –∑–Ω–∞—á–µ–Ω–∏—é 404.
3. –ï—Å–ª–∏ –¥–∞ ‚Äî –±–µ—Ä—ë—Ç —Å—Å—ã–ª–∫—É –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ B.
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
   - *–ë–∞–Ω 404*
   - —Å—Å—ã–ª–∫–∞ –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ B
5. –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞–Ω—ã –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–∏–ø—Ç–∞:
- Chat ID: 8003377702
- Bot Token: 8165444239:AAFGA_0Qi_sdFGaEKLc95Hr5fZjCd2UIWnM
*/
